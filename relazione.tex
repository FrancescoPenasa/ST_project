# reports of security testing project on Inventory-masdf...
## Francesco Penasa

# taint analysis
In order to find the XSS vulnerabilities present in the Inventory-shity, Pixy has been used.
All the vulnerabilities discovered has been writtenm in the Table01 at the end of this report.
Since the tool has been utilized to discover only possible vectors for XSS attacks, while all other classes of attacks has not been discovered, tainted and fixed. 

# security test cases
## TP cases
We have identified the following vulnerabilities reported by Pixy as True Positives. For each of them a test case has been written and a fix has been provided.
|---------------------------|--------------|--------|
|Pixy file					| description  | TP/FP	|
---------------------------------------------
|xss_dashboard.php_10_min		| the output from the DB is not satized for the object to are displa on 									the page | TP  
|xss_fetchBrand.php_1_min		|
|xss_fetchCategories.php_1_min	|
|xss_fetchOrder.php_1_min		|
|xss_fetchProduct.php_1_min		|
|xss_fetchUser.php_1_min		|
|xss_PRINTORDER					|
|xss_USERREPORT					|
|probably dashboard.php			|
-------------------------
|first of the FP 				| explanations | FP
|second 						|
|third							|
|fourth							| explanations | FP




in the following table we have all FP grouped by the motivation of this false result.

# security test cases
We have used Page Object method so it is easily scalable for many other test cases.
bla bla
all the vulnerabilities have the damn java file to make them work and every page has its own file
And all the files works properly, we have only two exceptions xss_PRINTORDER xss_USERREPORT which test cases do not works properly due to the fact that the proof of concept of the xss vulenrabilty it is displayed in a pdf file. there certantly may be

# fixes 
in  the following table are displayed the fixes provided in order to untainted the variables that makes XSS attacks possible in the inventory-managment-system

|---------------------------|--------------|--------|
|Pixy file					| description  | TP/FP	|
---------------------------------------------
|xss_dashboard.php_10_min		| the output from the DB is not satized for the object to are displa on 									the page | TP  
|xss_fetchBrand.php_1_min		|
|xss_fetchCategories.php_1_min	|
|xss_fetchOrder.php_1_min		|
|xss_fetchProduct.php_1_min		|
|xss_fetchUser.php_1_min		|
|xss_PRINTORDER					|
|xss_USERREPORT					|
|probably dashboard.php			|
-------------------------

FIXES

# xss_dashboard.php_10_min
TP
dashboard.php
`151 <?php while ($orderResult = mysqli_fetch_assoc($userwiseQuery)) { ?>`
`153 <td><?php echo $orderResult['username']?></td>`

FIX
`153 <td><?php echo (htmlentities($orderResult['username']))?></td> `

# xss_fetchBrand.php_1_min
`48 echo json_encode($output);`
`48 echo json_encode(htmlentities($output));`

`38 		htmlentities($row[1]),`

# xss_fetchCategories.php_1_min
`htmlentities($row[1]), 		`
`38 $row[1],`

# xss_fetchOrder.php_1_min
`55		// client name
 		$row[2], 
 		// client contact
 		$row[3], 	`
`55		// client name
 		htmlentities($row[2]), 
 		// client contact
 		htmlentities($row[3]), 	`


# xss_fetchProduct.php_1_min
`62  	// product name
 		htmlentities($row[1]), 
 		// rate
 		htmlentities($row[6]),
 		// quantity 
 		$row[5], 		 	
 		// brand
 		htmlentities($brand),
 		// category 		
 		htmlentities($category),`


# xss_fetchUser.php_1_min
`35 $output['data'][] = array( 		
 		// name
 		$username,
`

`35 $output['data'][] = array( 		
 		// name
 		htmlentities($username),
`


# xss_printOrder.php_1_min
`$clientName = $orderData[1];
$clientContact = $orderData[2];`

`$clientName = htmlentities($orderData[1]);
$clientContact = htmlentities($orderData[2]); `

`137                     <td style="border-left: 1px solid black;height: 27px;">'.htmlentities($row[4]).'</td`

# xss_getOrderReport.php_1_min
`
33				<td><center>'.htmlentities($result['client_name']).'</center></td>
34				<td><center>'.htmlentities($result['client_contact']).'</center></td>
				`


# honorable mentions 
in dashboard we see the count of the rows in product, while 

# annexes
1. cacl pager with the results of the static taint analysis
2. test cases
3. fixed code



TODO check for intval problems, the product that are gone forever are the problem!!!!
move test in the folder tests
in the zip report, test cases, patched source code




